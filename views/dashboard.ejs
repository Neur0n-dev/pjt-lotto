<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로또 대시보드</title>
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/lotto_favicon_32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/lotto_favicon_16.png">
    <link rel="icon" href="/assets/favicon.ico">
    <link rel="stylesheet" href="/css/dashboard.css?v=<%= Date.now() %>">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
</head>
<body>
    <!-- 헤더: 회차 이동 -->
    <header class="header">
        <button id="btn-prev" class="btn-nav" title="이전 회차">&#9664; 이전</button>
        <h1 id="drw-title" class="drw-title">--- 회차</h1>
        <button id="btn-next" class="btn-nav" title="다음 회차">다음 &#9654;</button>
        <a href="/pick" id="btn-pick" class="btn-pick" title="번호추천 받기">🍀 번호추천</a>
    </header>

    <!-- 1행: 요약 카드 4개 -->
    <section class="row row-summary">
        <div class="card card-summary">
            <div class="card-label">총 구매</div>
            <div class="card-value skeleton" id="total-purchases">-</div>
            <div class="card-sub">(전체)</div>
        </div>
        <div class="card card-summary">
            <div class="card-label">총 추천</div>
            <div class="card-value skeleton" id="total-recommends">-</div>
            <div class="card-sub">(전체)</div>
        </div>
        <div class="card card-summary">
            <div class="card-label">총 당첨</div>
            <div class="card-value skeleton" id="total-wins">-</div>
            <div class="card-sub">(전체)</div>
        </div>
        <div class="card card-summary">
            <div class="card-label">당첨률</div>
            <div class="card-value skeleton" id="win-rate">-</div>
            <div class="card-sub">(전체)</div>
        </div>
    </section>

    <!-- 2행: 실시간 카운터 | 구매 비율 | 추천 비율 -->
    <section class="row row-detail">
        <div class="card card-counter">
            <div class="counter-block">
                <div class="counter-label">실시간 구매</div>
                <div class="counter-value skeleton" id="purchase-count">-</div>
            </div>
            <hr>
            <div class="counter-block">
                <div class="counter-label">실시간 추천</div>
                <div class="counter-value skeleton" id="recommend-count">-</div>
            </div>
        </div>
        <div class="card card-chart skeleton">
            <h3>구매 유형 비율 <small>(해당 회차)</small></h3>
            <canvas id="chart-strategy"></canvas>
            <div class="empty-message">데이터 없음</div>
        </div>
        <div class="card card-chart skeleton">
            <h3>추천 전략 비율 <small>(해당 회차)</small></h3>
            <canvas id="chart-algorithm"></canvas>
            <div class="empty-message">데이터 없음</div>
        </div>
    </section>

    <!-- 3행: 구매빈도 TOP7 | 7회차 추이 | 등수 분포 -->
    <section class="row row-analytics">
        <div class="card card-chart skeleton">
            <h3>번호별 구매빈도 TOP 7 <small>(해당 회차)</small></h3>
            <canvas id="chart-top-numbers"></canvas>
            <div class="empty-message">데이터 없음</div>
        </div>
        <div class="card card-chart skeleton">
            <h3>최근 7회차 구매/추천 추이 <small>(회차별)</small></h3>
            <canvas id="chart-trend"></canvas>
            <div class="empty-message">데이터 없음</div>
        </div>
        <div class="card card-chart skeleton">
            <h3>전체 누적 당첨 등수 분포 <small>(전체)</small></h3>
            <canvas id="chart-rank"></canvas>
            <div class="empty-message">데이터 없음</div>
        </div>
    </section>

    <script>
        window.__DASHBOARD_DRW_NO__ = <%= drwNo ? drwNo : 'null' %>;
    </script>
    <script src="/js/dashboard.js?v=<%= Date.now() %>"></script>
</body>
</html>
